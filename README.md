## Проект: Трекер привычек с использованием DRF (деплой через docker)

## Стек:
* Python
* Django
* DRF
* PostgreSQL
* Redis
* Celery
* Docker
* Docker-compose

## Настройка проекта 
* Клонируем проект на свой репозиторий
* Создаём виртуальную машину (если ещё это не сделано), подключаемся командой `ssh root@<внешний ip-адрес>`
* Создаём пару ключей командой для pull с репозитория
  `ssh-keygen`
* Вам нужно полностью скопировать содержимое файла `id_rsa.pub` и добавить в свой git в разделе settings -> SSH and GPG keys (если в гитхаб копируете)
* Пулим проект командой `git pull`
* Прописать в config/settings.py адрес сервера в `ALLOWED_HOSTS = [<адрес сервера>]` - если ip-статический, если динамический, придётся при перезагрузке подменять ip, либо разрешить все значком "*" (небезопасно)
* Переименовать файл .env.example в .env и прописать невыставленные свои настройки. Получить секретный ключ можно встроенной командой джанго:
  `from django.core.management.utils import get_random_secret_key`


  `get_random_secret_key()`

* Если на сервере ещё не установлен Docker и Docker-compose, команда `apt install docker docker-compose`
* Запустить скрипт в корне проекта `./deploy.sh` или с указанием полного пути до скрипта, например `/home/user/deploy.sh` 
* Если выдало ошибку прав доступа, нужно добавить права исполняемости
  `chmod ugo+x deploy.sh`
* В Postman можно заполнить во вкладке headers "Autorization" = Bearer [ваш_токен_без_кавычек]
_Токен можно получить по адресу <ip-адрес>/users/login/_

* Или можно загрузить фикстуры в корне проекта 

`docker exec -it <ID контейнера приложения> python manage.py loaddata [данные].json`

* Зайдите в телеграм бот, конфигурируйте (шаги 1-6) и нажмите `/start`
[Гайд для конфигурации](https://vc.ru/dev/903659-kak-sozdat-bota-v-telegram-za-5-minut-botfather)
Оттуда получите токен, который подставляется в файл .env в корне проекта

## Критерии приемки курсовой работы
* Для разных сервисов создали отдельные контейнеры (django, postgresql, redis, celery, при необходимости список можно самостоятельно расширять).

* Всё оформили в файле docker-compose, при необходимости создали вспомогательные Dockerfiles.

* Проект готов быть размещенным на удаленном сервере: его можно запустить по инструкции, приложенной в Readme-файл; для запуска не требуется дополнительных настроек.

* Решение выложили на GitHub.
  
## DFR
* Настроили CORS.
* Настроили интеграцию с Телеграмом.
* Реализовали пагинацию.
* Использовали переменные окружения.
* Все необходимые модели описаны или переопределены.
* Все необходимые эндпоинты реализовали.
* Настроили все необходимые валидаторы.
* Описанные права доступа заложены.
* Настроили отложенную задачу через Celery.
* Проект покрыли тестами как минимум на 80%.
* Код оформили в соответствии с лучшими практиками.
* Имеется список зависимостей.
* Результат проверки Flake8 равен 100%, при исключении миграций.
* Решение выложили на GitHub.

## Описание задач

1. Добавьте необходимые модели привычек.
2. Реализуйте эндпоинты для работы с фронтендом.
3. Создайте приложение для работы с Telegram и рассылками напоминаний.

## Модели

В книге хороший пример привычки описывается как конкретное действие, которое можно уложить в одно предложение:

`я буду [ДЕЙСТВИЕ] в [ВРЕМЯ] в [МЕСТО]`

За каждую полезную привычку необходимо себя вознаграждать или сразу после делать приятную привычку. Но при этом привычка не должна расходовать на выполнение больше двух минут. Исходя из этого получаем первую модель — «Привычка».

Привычка:
* Пользователь — создатель привычки.
* Место — место, в котором необходимо выполнять привычку.
* Время — время, когда необходимо выполнять привычку.
* Действие — действие, которое представляет собой привычка.
* Признак приятной привычки — привычка, которую можно привязать к выполнению полезной привычки.
* Связанная привычка — привычка, которая связана с другой привычкой, важно указывать для полезных привычек, но не для приятных.
* Периодичность (по умолчанию ежедневная) — периодичность выполнения привычки для напоминания в днях.
* Вознаграждение — чем пользователь должен себя вознаградить после выполнения.
* Время на выполнение — время, которое предположительно потратит пользователь на выполнение привычки.
* Признак публичности — привычки можно публиковать в общий доступ, чтобы другие пользователи могли брать в пример чужие привычки.

Обратите внимание, что в проекте у вас может быть больше, чем одна описанная здесь модель.

_Чем отличается полезная привычка от приятной и связанной?_
_Полезная привычка — это само действие, которое пользователь будет совершать и получать за его выполнение определенное вознаграждение (приятная привычка или любое другое вознаграждение)._

_Приятная привычка — это способ вознаградить себя за выполнение полезной привычки. Приятная привычка указывается в качестве связанной для полезной привычки (в поле «Связанная привычка»)._

_Например: в качестве полезной привычки вы будете выходить на прогулку вокруг квартала сразу же после ужина. Вашим вознаграждением за это будет приятная привычка — принять ванну с пеной. То есть такая полезная привычка будет иметь связанную привычку._

_Рассмотрим другой пример: полезная привычка — «я буду не опаздывать на еженедельную встречу с друзьями в ресторан». В качестве вознаграждения вы заказываете себе десерт. В таком случае полезная привычка имеет вознаграждение, но не приятную привычку._

_Признак приятной привычки — булево поле, которые указывает на то, что привычка является приятной, а не полезной.__

## Валидаторы

Исключить одновременный выбор связанной привычки и указания вознаграждения.

_В модели не должно быть заполнено одновременно и поле вознаграждения, и поле связанной привычки. Можно заполнить только одно из двух полей._

* Время выполнения должно быть не больше 120 секунд.
* В связанные привычки могут попадать только привычки с признаком приятной привычки.
* У приятной привычки не может быть вознаграждения или связанной привычки.
* Нельзя выполнять привычку реже, чем 1 раз в 7 дней.

_Нельзя не выполнять привычку более 7 дней. Например, привычка может повторяться раз в неделю, но не раз в 2 недели. За одну неделю необходимо выполнить привычку хотя бы один раз._

## Пагинация

Для вывода списка привычек реализовать пагинацию с выводом по 5 привычек на страницу.

### Права доступа:

* Каждый пользователь имеет доступ только к своим привычкам по механизму CRUD.
* Пользователь может видеть список публичных привычек без возможности их как-то редактировать или удалять.

### Эндпоинты:

* Регистрация.
* Авторизация.
* Список привычек текущего пользователя с пагинацией.
* Список публичных привычек.
* Создание привычки.
* Редактирование привычки.
* Удаление привычки.

### Интеграция:

Для полноценной работы сервиса необходимо реализовать работу с отложенными задачами для напоминания о том, в какое время какие привычки необходимо выполнять.

Для этого потребуется интегрировать сервис с мессенджером Телеграм, который будет заниматься рассылкой уведомлений.

### Безопасность:

Для проекта необходимо настроить CORS, чтобы фронтенд мог подключаться к проекту на развернутом сервере.

### Документация:

Для реализации экранов силами фронтенд-разработчиков необходимо настроить вывод документации. При необходимости эндпоинты, на которые документация не будет сгенерирована автоматически, описать вручную.
